---
// src/components/ImageSlider.astro
interface Props {
  images: string[];
}

const { images } = Astro.props;
---

<div class="slider-container px-8 lg:px-52 p-8 bg-blueMain mt-20" 
     x-data="{
       currentIndex: 0,
       visibleImages: [],
       allImages: [],
       init() {
         // Pasamos las imágenes directamente al estado de Alpine
         this.allImages = JSON.parse(this.$el.dataset.images);
         this.updateVisibleImages();
       },
       updateVisibleImages() {
         this.visibleImages = [];
         for (let i = 0; i < 3; i++) {
           const index = (this.currentIndex + i) % this.allImages.length;
           this.visibleImages.push(this.allImages[index]);
         }
       },
       goForward() {
         this.currentIndex = (this.currentIndex + 3) % this.allImages.length;
         this.updateVisibleImages();
       },
       goBackward() {
         this.currentIndex = (this.currentIndex - 3 + this.allImages.length) % this.allImages.length;
         this.updateVisibleImages();
       }
     }"
     data-images={JSON.stringify(images)}> <!-- Pasamos las imágenes como data attribute -->
  <h1 class="text-white lg:text-4xl text-2xl mb-10">GALLERY</h1>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
    <template x-for="(image, index) in visibleImages" :key="index">
      <div class="overflow-hidden rounded-lg shadow-lg">
        <img
          :src="image"
          :alt="`Imagen ${currentIndex + index + 1}`"
          class="w-full h-48 object-cover transition-transform hover:scale-105 mb-4"
        />
        <p class="text-white font-bold lg:text-lg text-base">TEXTO DE LA IMAGEN</p>
      </div>
    </template>
  </div>
  <div class="mt-4 text-center text-gray-600" 
       x-text="`Mostrando imágenes ${currentIndex + 1} a ${Math.min(currentIndex + 1, allImages.length)} de ${allImages.length}`">
  </div>
  <div class="flex justify-end items-center mb-4 gap-4">
    <button
      @click="goBackward"
      class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
      aria-label="Anterior"
    >
      Anterior
    </button>
    <button
      @click="goForward"
      class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
      aria-label="Siguiente"
    >
      Siguiente
    </button>
  </div>
</div>

<script is:inline src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>