---
// src/components/LinkNavbarItem.astro
import LinkNavbarItem from './LinkNavbarItem.astro';

type MenuItem = {
  title: string;
  url: string;
  children?: MenuItem[];
};

const { item, depth = 0 } = Astro.props;
const hasChildren = item.children && item.children.length > 0;
---
<!-- Cada nivel de menú tiene su propio grupo -->
<style is:global>
  .nav-item {
    position: relative;
  }

  /* Submenu nivel 1 (debajo del ítem padre) */
  .nav-item > .submenu {
    left: 0;
    top: 100%;
    transform: translateY(10px);
  }

  /* Submenu nivel 2+ (a la derecha) */
  .nav-item .nav-item > .submenu {
    left: 100%;
    top: -0.5rem;
    transform: translateY(0);
  }

  .nav-item:hover > .submenu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .submenu {
    opacity: 0;
    visibility: hidden;
    position: absolute;
    min-width: 250px;
    background: white;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    transition: all 0.2s ease;
    z-index: 50;
  }
</style>

<div class="nav-item">
  <a
    href={item.url}
    class={`
      flex items-center justify-between gap-2
      px-4 py-3
      font-bold
      ${depth === 0 ? 'text-gray-900' : 'text-gray-600'}
      hover:text-red-600 hover:bg-amber-50
      rounded-lg
      transition-colors
      ${hasChildren ? 'pr-2' : ''}
    `}
  >
    <span>{item.title}</span>
    {hasChildren && (
      <svg
        class={`w-4 h-4 text-red-500 ${
          depth === 0 ? 'rotate-90' : ''  // Flecha hacia abajo solo en primer nivel
        }`}
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    )}
  </a>

  {hasChildren && (
    <ul class="submenu">
      {item.children.map((child : MenuItem) => (
        <li>
          <LinkNavbarItem item={child} depth={depth + 1} />
        </li>
      ))}
    </ul>
  )}
</div>